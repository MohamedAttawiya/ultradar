:root{
  --bg:#ffffff;
  --ink:#0f172a;          /* slate-900-ish */
  --muted:#64748b;        /* slate-500 */
  --border:#e2e8f0;       /* slate-200 */
  --brand:#111827;        /* near-black */
  --accent:#2563eb;       /* blue-600 */
  --accent-2:#0ea5e9;     /* sky-500 */
  --surface:#f8fafc;      /* slate-50 */
  --radius:16px;
  --shadow:0 2px 10px rgba(2,6,23,0.06);
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family:ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  color:var(--ink);
  background:var(--bg);
}

/* a11y */
.sr-only{
  position:absolute; width:1px; height:1px; padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
}

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:50; background:var(--bg);
  border-bottom:1px solid var(--border);
}
.topbar__inner{
  max-width:1100px; margin:0 auto; display:flex; align-items:center; gap:16px; padding:10px 16px;
}
.topbar__actions{
  margin-left:auto; display:flex; align-items:center; gap:16px; flex-wrap:wrap;
}
.brand{ display:inline-flex; align-items:center; gap:10px; text-decoration:none; }
.brand__logo{ height:34px; width:auto; }
.brand__text{
  color:var(--brand); font-weight:700; letter-spacing:.3px; text-transform:lowercase; font-size:1.05rem;
}

/* Nav */
.nav{ display:flex; gap:8px; }
.nav__link{
  color:var(--ink); text-decoration:none; padding:8px 12px; border-radius:10px;
  transition:background .15s ease, color .15s ease;
}
.nav__link:hover{ background:var(--surface); }
.nav__link.is-active{ color:var(--accent); background:rgba(37,99,235,0.08); }

/* Mobile nav toggle */
.nav__toggle{ display:none; background:transparent; border:none; cursor:pointer; }
.nav__toggle-bar{
  display:block; width:22px; height:2px; background:var(--ink); margin:4px 0; border-radius:2px;
}

/* Country switcher */
.country-switcher{ display:flex; align-items:center; gap:8px; font-size:.85rem; color:var(--muted); }
.country-switcher__label{ font-weight:600; }
.country-switcher__select{
  appearance:none; padding:6px 28px 6px 10px; border:1px solid var(--border); border-radius:999px;
  font-size:.9rem; background:url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" fill="none"%3E%3Cpath d="M1 1.5L6 6.5L11 1.5" stroke="%230f172a" stroke-width="1.5" stroke-linecap="round"/%3E%3C/svg%3E') no-repeat right 10px center/12px 8px, #fff;
  color:var(--ink); min-width:92px;
}
.country-switcher__select:focus{
  outline:none; border-color:rgba(37,99,235,0.4); box-shadow:0 0 0 2px rgba(37,99,235,0.18);
}

/* Layout */
.container{ max-width:1100px; margin:0 auto; padding:24px 16px 32px; }

/* Subnav */
.subnav{ border-bottom:1px solid var(--border); background:var(--bg); box-shadow:inset 0 -1px 0 rgba(15,23,42,0.04); }
.subnav__inner{
  max-width:1100px; margin:0 auto; display:flex; gap:12px; padding:12px 16px; overflow-x:auto; justify-content:center;
}
.subnav__link{
  flex:0 0 auto; text-decoration:none; color:var(--muted); font-weight:600; font-size:.95rem;
  padding:8px 14px; border-radius:999px; border:1px solid transparent;
  transition:color .15s ease, background .15s ease, border-color .15s ease;
}
.subnav__link:hover{ color:var(--accent); background:rgba(37,99,235,0.06); border-color:rgba(37,99,235,0.14); }
.subnav__link.is-active{ color:var(--accent); background:rgba(37,99,235,0.12); border-color:rgba(37,99,235,0.4); }

/* Hero */
.hero h1{ margin:0 0 8px; font-size:clamp(1.6rem, 2.5vw + 1rem, 2.3rem); }
.muted{ color:var(--muted); }

/* Buttons */
.cta-row{ display:flex; gap:10px; margin-top:16px; }
.btn{
  display:inline-block; text-decoration:none; background:var(--accent); color:#fff;
  padding:10px 14px; border-radius:12px; box-shadow:var(--shadow);
  transition:transform .06s ease, box-shadow .15s ease, background .15s ease;
}
.btn:hover{ transform:translateY(-1px); }
.btn--secondary{ background:var(--accent-2); }

/* Tiles */
.grid{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:14px; margin-top:28px;
}
.tile{
  display:block; border:1px solid var(--border); border-radius:var(--radius); padding:16px; text-decoration:none;
  color:inherit; background:var(--bg); box-shadow:var(--shadow);
  transition:transform .08s ease, box-shadow .15s ease, border-color .15s ease;
}
.tile:hover{ transform:translateY(-2px); box-shadow:0 8px 24px rgba(2,6,23,0.08); border-color:#cbd5e1; }
.tile__head{ font-weight:700; margin-bottom:6px; }
.tile__body{ color:var(--muted); margin:0; }

/* Footer */
.footer{
  margin-top:24px; background:#f9fafb; border-top:1px solid #e5e7eb;
}
.footer__inner{
  max-width:1100px; margin:0 auto; padding:14px 16px 24px; display:flex; align-items:center; justify-content:space-between;
}
.footer__logo:hover{ filter:brightness(1.05); transition:filter .2s ease; }

/* Panels / Controls */
.panel{ border:1px solid var(--border); border-radius:var(--radius); padding:14px; background:var(--bg); }
.panel__intro{ display:flex; flex-direction:column; gap:8px; }
.panel__intro + .slotcurves-controls{ margin-top:18px; }
.controls{ display:flex; flex-wrap:wrap; gap:10px; align-items:flex-end; }
.control{ display:flex; flex-direction:column; gap:6px; }
.control__label{ font-size:.9rem; color:var(--muted); }
.control__input{ padding:10px 12px; border:1px solid var(--border); border-radius:10px; background:#fff; min-width:220px; }

/* Status */
.status-message{ margin-top:16px; font-size:.9rem; color:var(--muted); display:none; }
.status-message[data-state]{ display:block; }
.status-message[data-state="loading"]{ color:var(--accent); }
.status-message[data-state="error"]{ color:#b91c1c; }
.status-message[data-state="success"]{ color:var(--ink); }

/* Heatmap cards grid (final) */
.store-heatmaps{
  display:grid;
  grid-template-columns:repeat(3, max-content); /* base: 3-up */
  gap:12px;
  justify-content:center;   /* center items */
  margin:0 auto;
}
.heatmap-card{
  border:1px solid rgba(15,23,42,0.1); border-radius:10px; padding:8px;
  box-shadow:0 4px 12px rgba(15,23,42,0.04); background:var(--bg);
  display:flex; flex-direction:column; gap:4px; width:max-content;
}
.heatmap-card__title{ margin:0; font-size:.85rem; font-weight:700; color:var(--ink); letter-spacing:.01em; }
.heatmap-card__subtitle{ margin:0; font-size:.6rem; color:var(--muted); text-transform:uppercase; letter-spacing:.08em; }
.heatmap-card__body{
  overflow:auto; border-radius:6px; border:1px solid rgba(15,23,42,0.18); background:#fff; padding:4px; width:max-content;
}

/* Heatmap legend */
.heatmap-legend{ display:flex; align-items:center; gap:12px; margin-top:18px; }
.heatmap-legend__label{ font-size:.72rem; color:var(--muted); text-transform:uppercase; letter-spacing:.04em; }
.heatmap-legend__gradient{
  flex:1; height:12px; border-radius:999px;
  background:linear-gradient(90deg, #22c55e 0%, #facc15 50%, #ef4444 100%);
  box-shadow:inset 0 0 0 1px rgba(15,23,42,0.12);
}

/* Heatmap table (final compact + square-ish mix) */
.heatmap-table{
  /* square-ish overall grid: 48 rows vs 7 cols */
  --cell-w:14px;                                /* base cell width */
  --cell-h:calc(var(--cell-w) * 0.1458333);     /* 7/48 */
  --cell-border:.5px;
  --label-col:36px;                              /* time column width */
  --head-h:12px;                                 /* header row height */

  table-layout:auto;
  width:max-content;
  border-collapse:separate;
  border-spacing:0;
  font-size:0;                                   /* kill gaps between tiny cells */
  color:#0f172a;
}
.heatmap-table thead th{
  background:#0f172a; color:#f8fafc; padding:0 2px; height:var(--head-h);
  line-height:var(--head-h); font-weight:600; text-align:center; font-size:.5rem; letter-spacing:.12em;
  border:1px solid rgba(15,23,42,0.5);
}
.heatmap-table thead th:first-child{
  text-align:left; position:sticky; left:0; z-index:2; min-width:var(--label-col);
}
.heatmap-table tbody th{
  background:#0f172a; color:#cbd5f5; padding:0 4px; font-weight:600; text-align:left;
  border:1px solid rgba(15,23,42,0.5); position:sticky; left:0; z-index:1; font-size:.5rem; letter-spacing:.04em; min-width:var(--label-col); line-height:1.1;
}
.heatmap-table tbody tr:nth-child(even) th{ background:#1e293b; color:#dbeafe; }
.heatmap-table tbody td{
  width:var(--cell-w); height:var(--cell-h); padding:0;
  border:var(--cell-border) solid rgba(15,23,42,0.25);
  background:var(--cell-color, #0f172a); position:relative; transition:background .2s ease;
}
.heatmap-table tbody td::after{ content:none; }               /* no square hack */
.heatmap-table tbody td:focus-visible{ outline:2px solid var(--accent); outline-offset:-2px; }

/* Generic tables */
.table-wrap{ overflow:auto; border:1px solid var(--border); border-radius:var(--radius); }
.table{ width:100%; border-collapse:separate; border-spacing:0; }
.table thead th{
  text-align:left; background:var(--surface); padding:10px 12px; border-bottom:1px solid var(--border); position:sticky; top:0;
}
.table tbody td{ padding:10px 12px; border-bottom:1px solid var(--border); }
.table tbody tr:hover{ background:#f9fbff; }
.error-box{ margin-top:10px; padding:10px 12px; border:1px solid #fecaca; background:#fff1f2; color:#7f1d1d; border-radius:10px; }

/* Responsive */
@media (max-width:820px){
  .nav__toggle{ display:inline-block; }
  .nav{ display:none; }
  .nav.is-open{
    display:grid; position:absolute; top:58px; right:8px; background:var(--bg);
    border:1px solid var(--border); padding:8px; gap:4px; border-radius:12px; box-shadow:var(--shadow);
  }
  .topbar__actions{ gap:12px; }
}
@media (max-width:640px){
  .topbar__actions{ gap:8px; }
  .country-switcher__label{ display:none; }
  .country-switcher__select{ min-width:72px; padding-right:24px; }
  .cta-row{ flex-direction:column; align-items:stretch; }
  .btn{ width:100%; text-align:center; }
}

/* Heatmap grid responsiveness (final) */
@media (max-width:980px){
  .store-heatmaps{ grid-template-columns:repeat(2, max-content); }
}
@media (max-width:640px){
  .store-heatmaps{
    grid-template-columns:1fr;
    justify-content:stretch;
  }
  .heatmap-card,
  .heatmap-card__body,
  .heatmap-table{ width:100%; }
}

/* Upscale tuning */
@media (min-width:1024px){
  .store-heatmaps{ grid-template-columns:repeat(4, max-content); gap:10px; }
  .heatmap-card{ padding:6px; }
  .heatmap-card__body{ padding:3px; }
  .heatmap-table{
    --cell-w:16px;                                /* tighter but legible on wide screens */
    --cell-h:calc(var(--cell-w) * 0.1458333);
    --label-col:32px;
    --cell-border:.5px;
  }
}
